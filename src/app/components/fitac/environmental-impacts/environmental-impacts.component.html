<div class="d-flex flex-column" [formGroup]="form">
    <ng-container formArrayName="arrays">
        <ng-container *ngFor="let itemForm of enviromentalImpactsForm; let i = index">
            <div class="d-flex flex-column mt-4 border rounded p-3" [formGroup]="itemForm">
                <div class="d-flex">
                    <h3>Impacto Ambiental {{i + 1}}</h3>
                    <button class="btn btn-outline-primary ms-auto p-2" title="Eliminar"
                        (click)="removeItemForm(i)" [disabled]="enviromentalImpactsForm.length == 1">
                        <i class="fs-4 fa-solid fa-trash"></i>
                    </button>
                </div>
                <div class="d-flex flex-wrap flex-column flex-md-row justify-content-between mt-2">
                    <div class="form-floating col-md-4">
                        <select id="ddlAmbientalDocumentType" class="form-select"  formControlName="stage">
                            <option value="" disabled>Seleccionar</option>
                            <option *ngFor="let option of stagesList" [value]="option.code">{{option.name}}</option>
                        </select>
                        <label for="ddlAmbientalDocumentType">Etapa</label>
                        <div class="invalid-feedback">Este campo es requerido</div>
                    </div>

                    <div class="form-floating col-md-4">
                        <input id="txtActivities" class="form-control" placeholder="-"
                            formControlName="activities" [ngClass]="{'is-invalid': hasError('activities', '', itemForm)}">
                        <label for="txtActivities">Actividades</label>
                        <div class="invalid-feedback">Este campo es requerido</div>
                    </div>

                    <div class="form-floating col-md-4">
                        <select id="txtComponent" class="form-select" formControlName="component">
                            <option value="" disabled>Seleccionar</option>
                            <option *ngFor="let option of impactComponentsList" [value]="option.code">{{option.name}}</option>
                        </select>
                        <label for="txtComponent">Componente</label>
                        <div class="invalid-feedback">Este campo es requerido</div>
                    </div>
                </div>

                <div class="d-flex flex-wrap flex-column flex-md-row justify-content-between mt-2">
                    <div class="form-floating col-md-6">
                        <input id="txtDescription" class="form-control" placeholder="-"
                            formControlName="description" [ngClass]="{'is-invalid': hasError('description', '', itemForm)}">
                        <label for="txtDescription">Descripción del Impacto Ambiental</label>
                        <div class="invalid-feedback">Este campo es requerido</div>
                    </div>

                    <div class="form-floating col-md-6">
                        <input id="txtPreventiveMeasures" class="form-control" placeholder="-"
                            formControlName="preventiveMeasures" [ngClass]="{'is-invalid': hasError('preventiveMeasures', '', itemForm)}">
                        <label for="txtPreventiveMeasures">Medidas de Prevención</label>
                        <div class="invalid-feedback">Este campo es requerido</div>
                    </div>
                </div>
            </div>
        </ng-container>
    </ng-container>
    <button class="btn btn-outline-primary ms-auto mt-3 me-3 p-1" (click)="addItemForm()" title="Agregar">
        <i class="fs-1 fa-solid fa-square-plus"></i>
    </button>
</div>
